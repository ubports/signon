#!/usr/bin/make -f
# -*- makefile -*-

# Uncomment this to turn on verbose mode.
#export DH_VERBOSE=1

# This has to be exported to make some magic below work.
export DH_OPTIONS
export NO_DOCS := no
export QMAKE_LIBDIR=/usr/lib
export DPKG_GENSYMBOLS_CHECK_LEVEL=4

override_dh_auto_configure:
	qmake LIBDIR=/usr/lib "QMAKE_CXXFLAGS=$(CFLAGS)" signon.pro

override_dh_install:
	rm -f debian/tmp/usr/include/signon-plugins/*example*.h
	rm -f debian/tmp/usr/include/signon-plugins/*test*.h
	rm -f debian/tmp/usr/lib/lib*.*a
	rm -f debian/tmp/usr/lib/signon/libexampleplugin.so
	rm -f debian/tmp/usr/share/qt4/mkspecs/features/signon-plugins-common.prf
	dh_install --fail-missing

%:
	dh $@ --with migrations
